{% from 'macros/button.html' import button, button_submit %}
{% extends "layout.html" %}

{% block id %}campaign-details{% endblock %}

{% block header %}
{% include "snippets/header.html" %}
<div class="actions">
  <div class="container">
    <div class="row">
      <div class="span12" data-bind="with: manager">
        <a class="cog" href="javascript:void(0)" data-bind="click: toggle">Manage your campaign</a>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block body %}
<section id="campaign-management" data-bind="visible: manager.visible" style="display: none">
  <div class="container">
    <div class="row">
      <div class="span12">
        <ul class="nav nav-tabs manage upper bold">
          <li class="active">
            <a href="#manage" data-toggle="tab">Manage</a>
          </li>
          <li>
            <a href="#promote" data-toggle="tab">Promote</a>
          </li>
          <li>
            <a href="#disburse" data-toggle="tab">Disburse</a>
          </li>
        </ul>
        <div class="halo white-background">
          <div id="manage" class="tab-body active" data-bind="with: manager">
            {% include "campaign/snippets/manage.html" %}
          </div>
          <div id="promote" class="tab-body" data-bind="with: promote">
            {% include "campaign/snippets/promote.html" %}
          </div>
          <div id="disburse" class="tab-body" data-bind="with: disburse">
            {% include "campaign/snippets/disburse.html" %}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<section id="campaign-header">
  <div class="container">
    <div class="img"></div>
    <div class="row">
      <div class="span5">
        <div class="campaign-name">
          <h1 class="upper">Kevin Berger's Fantasy Futbol 2012</h1>
        </div>
      </div>
    </div>
  </div>
</section>
<section id="campaign-meta">
  <div class="container">
    <div class="row">
      <div class="span12">
        <div class="social">
          <input type="button"
                 class="no-border circle circle-16 twitter-white-16 inline-block" />
          <input type="button"
                 class="no-border circle circle-16 facebook-white-16 inline-block" />
        </div>
        <div class="organizer">
            <div>Organized by</div>
            <div class="upper bold">
              <span class="teal">Kevin Berger</span>
              <span class="sep">|</span>
              <span>Member since</span>
              <span class="date">05.06.2012</span>
            </div>
        </div>
      </div>
    </div>
  </div>
</section>
<section id="campaign-status">
  <div class="container">
    <div class="row">
      <div class="span5 media">
        <div class="primary">
          <img alt="soccer01" src="{{ url_for('static', filename='img/mock/soccer-01.jpg') }}" />
        </div>
      </div>
      <div class="span7 status">
        <div class="halo">
          <div class="span4">
            <div class="goal">
              <div data-bind="if: campaign().target, visible: campaign().target">
                <h2>Goal</h2>
                <h2 class="green" data-bind="text: campaign().target().valueUI">$20,000</h2>
              </div>
              <div data-bind="ifnot: campaign().target, visible: !campaign().target()" style="display: none">
                <h2>Deadline</h2>
                <h2 class="green" style="text-transform: none" data-bind="text: deadlineUI"></h2>
              </div>
            </div>
            <hr />
            <div class="metrics">
              <div class="span2">
                <h3>Current Total</h3>
                <div class="total teal" data-bind="text: campaign().balanceUI">$250</div>
              </div>
              <div class="span2">
                <h3>Poold In</h3>
                <div class="poold" data-bind="text: campaign().participants">5</div>
              </div>
              <div class="clearfix"></div>
            </div>
            <hr />
            <div class="time">
              <h3>Time Left:</h3>
              <span class="days" data-bind="text: daysUI">4 days</span>
              <span class="hours" data-bind="text: hoursUI">5 hours</span>
              <span class="minutes" data-bind="text: minutesUI">0 mins</span>
              <span style="display: none"
                    class="seconds teal-background white"
                    data-bind="text: secondsUI, visible: remaining() < 61"></span>
            </div>
          </div>
          <div class="span2 call-to-action" data-bind="with: campaign">
            <div class="pie">
              <div id="pie-chart" class="relative">
                <div class="layer">
                  <h3><span data-bind="text: progressUI"></span></h3>
                  <h4 class="upper">Complete</h4>
                </div>
              </div>
            </div>
            {{ button("Cough it up", color="green") }}
          </div>
          <div class="clearfix"></div>
        </div>
      </div>
    </div>
  </div>
</section>
<section id="campaign-description">
  <div class="container">
    <div class="row">
      <div class="span8">
        <div class="bold upper">Description</div>
        <hr class="heading" />
        <div>
          <span class="bold">Start Date:</span>
          <span class="date">08/09/2012</span>
          <span class="sep"></span>
          <span class="bold">End Date:</span>
          <span class="date">08/20/2012</span>
        </div>
        <p>
          Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do
          eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim
          ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut
          aliquip ex ea commodo consequat. Duis aute irure dolor in
          reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
          pariatur. Excepteur sint occaecat cupidatat non proident, sunt in
          culpa qui officia deserunt mollit anim id est laborum.
        </p>
      </div>
      <div class="span4">
        <div class="bold upper">Amazon.com Product Details</div>
        <hr class="heading" />
        <div class="bold">Xbox 360 Kinect Bundle</div>
        <div class="dark-gray">from <span class="bold">$385</span></div>
        <br />
        <div class="">
          <a href="javascript:void(0)">Check out the details at Amazon.com</a>
        </div>
      </div>
    </div>
  </div>
</section>
<section id="campaign-social">
  <div class="container">
    <div class="row">
      <div class="span12">
      <ul class="nav nav-tabs upper bold">
        <li class="active">
          <a href="#campaign-invitees" data-toggle="tab">Invitees</a>
        </li>
        <li>
          <a href="#campaign-messages" data-toggle="tab">Message Board</a>
        </li>
      </ul>
      </div>
    </div>
  </div>
</section>
<section id="campaign-invitees" class="tab-body active">
  <div class="container">
    <div class="row light-gray-background">
      <div class="span12">
        <div class="actions pull-right">
          {{ button("Promote", size="small", color="teal") }}
        </div>
        <div class="filters">
          <input type="button" class="active clean" value="All (255)" />
          <span class="sep"></span>
          <input type="button" class="clean" value="Backers (65)" />
          <span class="sep"></span>
          <input type="button" class="clean" value="Not Yet Responded (190)" />
        </div>
        <hr />
        <div class="invitees">
          <ul class="inline-block">
            {% for i in range(0, 4) %}
            <li>
              <div class="avatar avatar-100">
                <div class="layer overlay"></div>
                <div class="layer content">$50</div>
                <img alt="Tux" src="{{ url_for('static', filename='img/mock/tux.png') }}" />
              </div>
              <div class="name">Tux</div>
            </li>
            {% endfor %}
            {% for i in range(0, 12) %}
            <li>
              <div class="avatar avatar-100">
                <img alt="Tux" src="{{ url_for('static', filename='img/mock/tux.png') }}" />
              </div>
              <div class="name">Tux</div>
            </li>
            {% endfor %}
          </ul>
        </div>
        <hr />
        <div class="paging">
          <input type="button" class="prev clean" value="«" />
          <input type="button" class="active clean" value="1" />
          <span class="sep">|</span>
          <input type="button" class="clean" value="2" />
          <span class="sep">|</span>
          <input type="button" class="clean" value="3" />
          <input type="button" class="next active clean" value="»" />
        </div>
      </div>
    </div>
  </div>
</section>
<section id="campaign-messages" class="tab-body">
  <div class="container">
    <div class="row light-gray-background">
      <div class="span12">
        <span style="font-size: 1.0em; font-style: italic; color: #000;">Coming soon...</span>
      </div>
    </div>
  </div>
</section>
{% include "snippets/upload.html" %}
{% endblock %}

{% block init %}
<script src="{{ url_for('static', filename='script/graph.js') }}"></script>
<script>
  var deadline = moment().add('hours', 5).
                          add('days', 4).
                          add('minutes', 1).
                          toDate().
                          getTime()

  var started = moment().add('hours', -9).
                         add('days', -2).
                         toDate().
                         getTime()

  PI.CampaignDetails.init(PI.Campaign.load({
    started: started,
    deadline: deadline,
    participants: 5,
    balance: 250,
    target: {
      type: 'money',
      value: 20000
    }
  }));

  function target(type, value) {
    PI.page.campaign().update({
      target: {
        type: type,
        value: value
      }
    });
  }

  function target_users() {
    target('number', 20);
  }

  function target_money() {
    target('money', 20000);
  }

  function target_unknown() {
    PI.page.campaign().update({ target: null });
  }

  function deadline(days, hours, minutes, seconds) {
    ts = moment()
    ts.add('days', i == null ? 1 : days)

    if (hours) ts.add('hours', hours)
    if (minutes) ts.add('minutes', minutes)
    if (seconds) ts.add('seconds', seconds)

    PI.page.campaign().update({ deadline: ts.valueOf() });
  }

  function deadline_hour(i) {
    ts = moment().add('hours', i || 1)
    PI.page.campaign().update({ deadline: ts.valueOf() });
  }

  function deadline_minute(i) {
    ts = moment().add('minutes', i || 1)
    PI.page.campaign().update({ deadline: ts.valueOf() });
  }

  function deadline_second(i) {
    ts = moment().add('seconds', i || 10)
    PI.page.campaign().update({ deadline: ts.valueOf() });
  }
</script>
{% endblock %}
